# Smallstep Setup

## Introduction

Smallstep with cert-manager to setup internal CA with acme as a provisioner.
trust-manager will trust the cert when pod(client) wants to talk ingress(Traefik/Nginx)

### Steps

> NOTE: you need cert-manager to be installed on your k8s cluster.

* Deploy step-ca app from [kubeaid/step-ca](https://github.com/Obmondo/kubeaid/tree/master/argocd-helm-charts/step-ca) which will deploy step-certificate, step-issuer and trust-manager

* Fix values.yaml in your kubeaid-config repo


* Deploy step-ca app

* Take shell on `step-ca-step-certificates-0`

```
step-ca-step-certificates-0:~$ step ca root
-----BEGIN CERTIFICATE-----
CCAWmgAwIBAgIQaA20D5GrvYaJTSVjAKBggqhkjOPQQDAjBAMRow
QKExFTdGVwIENlcnRpZlczEiMCAGA1UEAxMZU3RlcCBDZXJ0aWZp
MgUm9vdCBDQTAeFw0yNwMTU1MjBaFw0zNTA4MTIwMTU1MjBaMEAx
NVBAoTEVN0ZXAgQ2VydhdGVzMSIwIAYDVQQDExlTdGVwIENlcnRp
RlcyBSb290IENBMFkwEIzj0CAQYIKoZIzj0DAQcDQgAEvLGYLW+1
xBY9iegPMvZ5qm7ssdSsMny2eiF+CI1lTZ1SgEg3J31BeOJhddY/
BbTJM5BqNFMEMwDgYDV/BAQDAgEGMBIGA1UdEwEB/wQIMAYBAf8C
YDVR0OBBYEFHQX25cmwou/hHgN4T8O6jMAoGCCqGSM49BAMCA0gA
DbMl1Df6xqj4JpGF9jOsObd2tiQJaTIpenB9LAIgNTWVmITiH9B5
LRLyKFFniDfZtdSvzlw=
-----END CERTIFICATE-----
```

*
