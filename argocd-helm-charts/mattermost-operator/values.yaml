mattermost:
  name: mattermost
  image: mattermost/mattermost-enterprise-edition
  imagePullPolicy: IfNotPresent
  version: 10.9.4
  size: 5000users
  useServiceLoadBalancer: false
  serviceAnnotations: {}
  ingress:
    enabled: true
    host: mattermost-staging.obmondo.com
    annotations:
      nginx.ingress.kubernetes.io/ssl-redirect: "true"
      kubernetes.io/tls-acme: "true"
      cert-manager.io/cluster-issuer: letsencrypt
      kubernetes.io/ingress.class: traefik-cert-manager
  mattermostEnv:
    - name: MM_DB_USERNAME
      valueFrom:
        secretKeyRef:
          name: mattermost-pgsql-app
          key: username
    - name: MM_DB_PASSWORD
      valueFrom:
        secretKeyRef:
          name: mattermost-pgsql-app
          key: password
    - name: MM_SQLSETTINGS_DATASOURCE
      value: postgres://$(MM_DB_USERNAME):$(MM_DB_PASSWORD)@mattermost-pgsql-rw:5432/mattermost?sslmode=require&connect_timeout=100
    - name: MM_FILESETTINGS_AMAZONS3SSE
      value: "true"
    - name: MM_FILESETTINGS_AMAZONS3SSL
      value: "true"
  licenseSecret: ""                      # Set your secret name if using enterprise license
  fileStore:
    external:
      url: s3.obmondo.com
      bucket: kbm-postgres-backups
      secret: mattermost-pgsql-filestore-creds

postgres:
  size: 8Gi
  recover: false
  pass: mattermost-pgsql-app
  resources:
    limits:
      memory: 800Mi
      cpu: 250m
    requests:
      memory: 500Mi
      cpu: 250m
